<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ å›½å®¶æ„å¿—æ¨¡æ‹Ÿå™¨</title>
  
  <style>
    /* é¡µé¢æ•´ä½“æ ·å¼ */
    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #0d1b2a, #1b263b);
      color: #e0e1dd;
      padding: 10px;
      margin: 0;
    }
    .container {
      background: rgba(23, 32, 45, 0.95);
      border-radius: 10px;
      padding: 15px;
      max-width: 420px;
      margin: 0 auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    }
    .panel {
      background: rgba(31, 48, 68, 0.8);
      border-radius: 8px;
      margin-bottom: 8px;
      padding: 8px;
      font-size: 0.85rem;
    }

    .options label {
      display: block;
      background: rgba(31, 48, 68, 0.8);
      border-radius: 8px;
      margin-bottom: 6px;
      padding: 6px;
      font-size: 0.8rem;
    }
      background: rgba(31, 48, 68, 0.8);
      border-radius: 8px;
      margin-bottom: 8px;
      padding: 8px;
      font-size: 0.85rem;
    }
    button {
      background: #415a77;
      color: white;
      width: 100%;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      margin-top: 6px;
    }
    button:hover { background: #778da9; }
    .labor-summary { text-align: center; font-size: 0.85rem; color: #a9b6c2; }
  </style>
</head>
<body>
<div class="container">
  <h2>ğŸŒ å›½å®¶æ„å¿—æ¨¡æ‹Ÿå™¨</h2>
  <div class="panel" id="statusPanel"></div>
  <div class="panel" id="situationPanel"></div>
  <div class="panel options" id="optionsPanel"></div>
  <div class="labor-summary" id="laborSummary">å·²é€‰æ‹©åŠ³åŠ¨åŠ›: 0</div>
  <button id="submitBtn">âœ… æ‰§è¡Œå‹¾é€‰é€‰é¡¹</button>
  <div class="panel" id="chat"></div>
</div>

<script>
// çŠ¶æ€æ•°æ®å®šä¹‰
const state = {
  population: 60, tools: 20, food: 70, water: 80, morale: 85,
  tech: 3, culture: 2, belief: 'å›¾è…¾ç¥­ç¥€', economy: 1,
  org: 'éƒ¨è½è®®ä¼š', form: 'åŸå§‹éƒ¨è½', season: 1, location: 'æ£®æ—è¾¹ç¼˜', starving: false
};

// è¡ŒåŠ¨é€‰é¡¹å®šä¹‰
const actions = {
  // æŠ€æœ¯å‘å±•ç±»
  sharpStoneTools: { title: 'ğŸ—¿ åŸå§‹å·¥å…·æ”¹è¿›', desc: 'åˆ¶ä½œæ›´é”‹åˆ©çš„çŸ³å™¨ï¼Œæå‡ç‹©çŒæ•ˆç‡', labor: 10, exec(){state.tools+=10;} },
  controlFire: { title: 'ğŸ”¥ ç«çš„æ§åˆ¶', desc: 'å»ºç«‹æ°¸ä¹…ç«æºï¼Œæå‡é£Ÿç‰©ä¿å­˜å’Œé˜²å¾¡èƒ½åŠ›', labor: 15, exec(){state.food+=10; state.morale+=5;} },
  weavingTech: { title: 'ğŸ§º ç¼–ç»‡æŠ€æœ¯', desc: 'åˆ¶ä½œæ¤ç‰©çº¤ç»´å®¹å™¨ï¼Œæé«˜é£Ÿç‰©å‚¨å­˜', labor: 8, exec(){state.food+=15;} },
  primitiveAgriculture: { title: 'ğŸŒ¾ åŸå§‹å†œä¸š', desc: 'å°è¯•ç§æ¤è°·ç‰©ï¼Œå¼€å¯å†œä¸šæŠ€æœ¯', labor: 20, exec(){state.tech+=2; state.food+=20;} },
  fishingTech: { title: 'ğŸ£ æ•é±¼æŠ€æœ¯', desc: 'åˆ¶ä½œæ¸”ç½‘ï¼Œå¢åŠ é£Ÿç‰©å¤šæ ·æ€§', labor: 12, exec(){state.food+=25;} },

  // ç¤¾ä¼šç»„ç»‡ç±»
  tribalDivision: { title: 'ğŸ‘¥ éƒ¨è½åˆ†å·¥', desc: 'åˆ†é…å°ç»„ï¼Œæé«˜æ•ˆç‡', labor: 10, exec(){state.tech+=1;} },
  tribalCouncil: { title: 'ğŸ›ï¸ å»ºç«‹éƒ¨è½ä¼šè®®', desc: 'å½¢æˆå†³ç­–æœºåˆ¶', labor: 15, exec(){state.culture+=2;} },
  hierarchySystem: { title: 'ğŸ”º é•¿å¹¼å°Šå‘', desc: 'å»ºç«‹ç­‰çº§åˆ¶åº¦', labor: 12, exec(){state.morale-=5; state.culture+=2;} },
  marriageSystem: { title: 'ğŸ’‘ å©šå§»åˆ¶åº¦', desc: 'è§„èŒƒå©šé…å…³ç³»ï¼Œå¢åŠ äººå£', labor: 8, exec(){state.population+=5;} },
  tribalRituals: { title: 'ğŸ‰ éƒ¨è½ä»ªå¼', desc: 'å»ºç«‹ä»ªå¼ï¼Œæé«˜å‡èšåŠ›', labor: 10, exec(){state.morale+=10; state.culture+=1;} },

  // èµ„æºç®¡ç†ç±»
  foodStorage: { title: 'ğŸ– é£Ÿç‰©å‚¨å­˜', desc: 'å»ºé€ å‚¨è—å®¤', labor: 15, exec(){state.food+=30;} },
  waterProtection: { title: 'ğŸ’§ æ°´æºä¿æŠ¤', desc: 'ä¿æŠ¤æ°´æºï¼Œå¢åŠ å¥åº·', labor: 12, exec(){state.morale+=5;} },
  resourceExploration: { title: 'â›ï¸ èµ„æºå‹˜æ¢', desc: 'å¯»æ‰¾çŸ¿æº', labor: 18, exec(){state.tools+=15;} },
  seasonalMigration: { title: 'ğŸŒ å­£èŠ‚è¿ç§»', desc: 'å»ºç«‹å†¬å¤è¥åœ°', labor: 20, exec(){state.morale+=15;} },

  // é˜²å¾¡ä¸æ‰©å¼ ç±»
  campDefense: { title: 'ğŸ›¡ï¸ è¥åœ°é˜²å¾¡', desc: 'å»ºé€ å›´æ ', labor: 15, exec(){state.morale+=10;} },
  weaponMaking: { title: 'ğŸ¹ æ­¦å™¨åˆ¶ä½œ', desc: 'åˆ¶ä½œçŸ›å’ŒæŠ•æ·æ£’', labor: 12, exec(){state.tools+=10; state.morale+=5;} },
  areaScouting: { title: 'ğŸ—ºï¸ ä¾¦å¯Ÿå‘¨è¾¹', desc: 'ç»˜åˆ¶åœ°å›¾', labor: 10, exec(){state.tech+=1;} },
  tribeExpansion: { title: 'ğŸï¸ éƒ¨è½æ‰©å¼ ', desc: 'å¸çº³å°ç¾¤ä½“', labor: 25, exec(){state.population+=10; state.morale-=5;} },

  // æ–‡åŒ–ä¿¡ä»°ç±»
  natureWorship: { title: 'ğŸŒ³ è‡ªç„¶å´‡æ‹œ', desc: 'å»ºç«‹ç¥­ç¥€åœ°ç‚¹', labor: 15, exec(){state.belief='è‡ªç„¶å´‡æ‹œ';} },
  ancestorWorship: { title: 'ğŸ—¿ ç¥–å…ˆå´‡æ‹œ', desc: 'å»ºç«‹ç¥­å›', labor: 12, exec(){state.culture+=2;} },
  rockArt: { title: 'ğŸ¨ å²©ç”»è‰ºæœ¯', desc: 'ç»˜åˆ¶å£ç”»', labor: 8, exec(){state.culture+=1;} },
  mythologyCreation: { title: 'ğŸ“– ç¥è¯ä¼ è¯´', desc: 'åˆ›é€ èµ·æºæ•…äº‹', labor: 10, exec(){state.morale+=5;} }
};

// æ›´æ–°é¢æ¿æ˜¾ç¤º
function updatePanels() {
  state.availableLabor = Math.floor(state.population * 0.8);
  document.getElementById("statusPanel").innerHTML = `äººå£: ${state.population}/100 | é£Ÿç‰©: ${state.food}/200 | å·¥å…·: ${state.tools}/100<br>æŠ€æœ¯: ${state.tech}/10 | æ–‡åŒ–: ${state.culture}/10 | å£«æ°”: ${state.morale}/100`;
  document.getElementById("situationPanel").innerHTML = `å­£åº¦: ${state.season} | ä½ç½®: ${state.location}<br>ç¤¾ä¼šå½¢æ€: ${state.form} | ç»„ç»‡: ${state.org}<br>å¯ç”¨åŠ³åŠ¨åŠ›: ${state.availableLabor}`;
}

// æ˜¾ç¤ºé€‰é¡¹
function showOptions() {
  document.getElementById("optionsPanel").innerHTML = Object.entries(actions).map(([k,v])=>`<label><input type="checkbox" data-labor="${v.labor}" value="${k}">${v.title}(${v.labor}) - ${v.desc}</label>`).join('');
}

// åŠ³åŠ¨åŠ›é€‰æ‹©å®æ—¶æ›´æ–°
optionsPanel.onchange = ()=>{
  let selectedLabor = [...document.querySelectorAll('input:checked')].reduce((s,el)=>s+parseInt(el.getAttribute('data-labor')),0);
  laborSummary.innerText = `å·²é€‰æ‹©åŠ³åŠ¨åŠ›: ${selectedLabor}`;
};

// æäº¤é€‰æ‹©å¹¶å¤„ç†å­£åº¦æ¨è¿›
submitBtn.onclick = ()=>{
  let selectedLabor=[...document.querySelectorAll('input:checked')].reduce((s,el)=>s+parseInt(el.getAttribute('data-labor')),0);
  if(selectedLabor>state.availableLabor)return alert('åŠ³åŠ¨åŠ›ä¸è¶³');
  [...document.querySelectorAll('input:checked')].forEach(el=>actions[el.value].exec());
  handleEvents();
  endTurn();
};

// å­£åº¦ç»“æŸå¤„ç†ï¼ˆé¥¥è’æœºåˆ¶ï¼‰
function endTurn() {
  state.food -= 10; state.water -= 5;
  if(state.food <= 0){
    state.food = 0;
    if(state.starving){state.population-=8; state.morale-=20; appendChat('ğŸ¥€ é¥¥è’æŒç»­ï¼Œäººå£å‡å°‘ï¼Œå£«æ°”ä¸‹é™ã€‚');}
    else{appendChat('âš ï¸ é£Ÿç‰©è€—å°½ï¼Œå‡ºç°é¥¥è’ï¼');}
    state.starving = true;
  }else{state.starving=false;}
  state.season++;
  updatePanels(); showOptions();
  laborSummary.innerText = 'å·²é€‰æ‹©åŠ³åŠ¨åŠ›: 0';
}

// éšæœºäº‹ä»¶æœºåˆ¶
function handleEvents(){
  if(Math.random()<0.3){
    const eventMsgs=['ğŸŒŠ æ´ªæ°´è¢­å‡»ï¼Œé£Ÿç‰©å‡å°‘ï¼','ğŸ¤’ ç–¾ç—…æµè¡Œï¼Œäººå£å‡å°‘ï¼','ğŸ”¥ å‘ç”Ÿçº·äº‰ï¼Œå£«æ°”ä¸‹é™ï¼'];
    let event=eventMsgs[Math.floor(Math.random()*eventMsgs.length)];
    if(event.includes('é£Ÿç‰©')) state.food-=15;
    if(event.includes('äººå£')) state.population-=5;
    if(event.includes('å£«æ°”')) state.morale-=10;
    appendChat(event);
  }
}

// æ·»åŠ èŠå¤©ä¿¡æ¯
function appendChat(msg) {chat.innerHTML += `<div>${msg}</div>`;}

// åˆå§‹åŒ–
updatePanels(); showOptions();
</script>
</body>
</html>
